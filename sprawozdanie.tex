
\documentclass[varwidth,12pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage{csvsimple}
\usepackage{booktabs}
\usepackage[MeX]{polski}
\usepackage{graphicx}   %do rysunków
\usepackage{wrapfig}    %do rysunków otoczonych tekstem
\usepackage{color}      %do użycia podst. kolorów oraz zdefiniowanych kolorów 
\usepackage{amsmath}

%do kolorowych referencji do rysunków, cytowań:
\usepackage{multicol}
\usepackage{colortbl}
\usepackage[colorlinks=true,linkcolor=firebrick,citecolor=green]{hyperref}

%do zdefiniowana własnych kolorów:
\definecolor{darkred}{rgb}{0.5,0,0}
\definecolor{darkblue}{rgb}{0,0,0.5}
\definecolor{firebrick}{rgb}{0.75,0.125,0.125}
\definecolor{darkgreen}{rgb}{0,0.5,0}

\textwidth=16cm
\textheight=23cm
\topmargin=-2cm
\oddsidemargin=0cm
%%%% https://www.sharelatex.com/learn/Page_size_and_margins


\title{Sprawozdanie}
\author{Artur Dziedziczak}
\date{\today}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

\section{Opis zjawiska}

Treść zadania jest rozbudowana jednak na wstępie chciałbym powtórzyć opis zjawiska, które w dalszej części będzie podlegało symulacji.

Zjawiskiem tym jest proces chłodzenia metalowego pręta w specjalnym oleju. Do najważniejszych elementów zjawiska należą zmiany temepratury
pręta $T_p$ oraz oleju $T_w$.

Olej jak i pręt posiadają pewną masę $m_w, m_b$, od której w dużej mierze zależy szybkość zmian temperatury. Jeżeli 
duży kontener wypełnimy olejem i wrzucimy do niego pręt o małej masie zostanie on szybciej schłodzony.

Na szybkość zachodzenia reakcji zmian temperatury ma również wpływ współczynnik $A$, który jest sumaryczną powierzchnią
ścianek pręta.

\section{Model matematyczny}

Opisany w sekcji \textbf{Opis zjawiska} proces ma swój model matematyczny, który pozwala na określenie zmian temperatur.
\newline

Równania stanu

\begin{align}
    \frac{m_b c_b}{hA} \frac{dT_b}{dt} + T_b = T_w  \\
    \frac{m_w c_w}{hA} \frac{dT_w}{dt} + T_w = T_b  \nonumber
\end{align}

należy przekształcić do formy umożliwiającej obliczenie pochodnych po czasie

\begin{equation}
     \begin{cases}
    \frac{\partial T_b}{\partial t}=\frac{(T_w-T_b)*h*a}{m_b*c_b} \\
    \frac{\partial T_w}{\partial t}=\frac{(T_b-T_w)*h*a}{m_w*c_w} 
    \end{cases}
\end{equation}

układ tych równań różniczkowych przy pomocy metody Eulera i Ulepszonej metody Eulera pozwala na obliczenie $T_b, T_w$ dla pewnego kroku.

\subsection{Metoda Eulera}

Zakładając, że mamy jakąś funkcję $\frac{dy}{dt}' = f(t,y)$
zgodnie z definicją pochodnej możemy zapisać
\begin{equation}
   \frac{dy}{dt} \approx \frac{\Delta y}{\Delta t} = \frac{y_{i+1} - y_i}{t_{i+1} - t_i} = f(t_i, y_i)
\end{equation}
możemy przekształcić przez przemnożenie przez $\Delta t$

\begin{equation}
    \Delta y = \Delta t * f(t_i, y_i)
\end{equation}

Ponieważ szukamy wzoru na $y_{n+1}$ zatem do wzoru

\begin{equation}
    y_{n+1} = y_n + \Delta y
\end{equation}

Podstawiamy

\begin{equation}
    y_{i+1} = y_i + \Delta t * f(t_i, y_i)
\end{equation}

Co pozwala nam na przybliżanie wartości pochodnej numerycznie.

\subsection{Ulepszona metoda Eulera}

Różni się od podstowej tym, że iteracje odbywają się wzdłóż prostej o współczynniku
kierunkowym równym współczynnikowi stycznej do krzywej w punkcie oddalonym od 
$x_0$ o $\frac{h}{2}$.

\begin{equation}
    y_n = y_{n-1} + hf(x_{n-1} + \frac{h}{2}, y_{n-1} + \frac{h}{2} f(x_{n-1}, y_{n-1})
\end{equation}

\subsection{Funkcje sklejane 3 stopnia}

Interpolacja funkcjami sklejanymi 3 stopnia (Cubic spines interpolation)

Interpolacja ta odbywa się poprzez stworzenie funkcji wielomianów trzeciego stopnia $ p_k(x) $
dla różnych interwałów $ [[x^k, x^{k+1}] $.

$$
    f(x) = \left\{ \begin{array}{ll}
    p_1 (x) & \textrm{$x_1 <= x < x_2$}\\
    p_2 (x) & \textrm{$x_2 <= x < x_3$}\\
    \vdots  & \vdots \\
    p_{m-1} (x) & \textrm{$x_{m-1} <= x < x_m$}\\
    \end{array} \right.
$$

Dla punktów $(x_1, y_1), (x_2, y_2), ..., (x_m, y_m)$ dla, których $x_1 < x_2 < ... < x_m $
należy utworzyć krzywą sześcienną poprzez interpolacje wielomianu stopnia trzeciego $p_k$ 
pomiędzy każdą z kolejnych par punktów $(x_k, y_k)$ oraz $x_{k}, y_{k+1}$ zgodnie z takimi ograniczeniami:

1. Każdy z wielomianów przechodzi przez kolejne punkty
\begin{equation}
    p_k (x_k) = y_k oraz p_k (x_{k+1}) = y_{k + 1}
\end{equation}

2. Każda pierwsza pochodna dla punktów wewnętrznych jest sobie równa
\begin{equation}
     \frac{\partial d}{\partial dx} p_jk (x_{k+1}) = \frac{\partial d}{\partial dx} p_{k+1} (x_{k+1})
\end{equation}

3. Druga pochodna dla punktów wewnętrznych jest sobie równa
\begin{equation}
     \frac{\partial d^2}{\partial dx^2} p_jk (x_{k+1}) = \frac{\partial d^2}{\partial dx^2} p_{k+1} (x_{k+1})
\end{equation}

4. Druga pochodna wynosi zero na punktach końcowych
\begin{equation}
     \frac{\partial d^2}{\partial dx^2} p_1 (x_{1}) = 0 oraz \frac{\partial d^2}{\partial dx^2} p_{m-1} (x_{m}) = 0
\end{equation}

Wielomian, który rozpatrujemy ma postać
\begin{equation}
    p(x) = a_i \Delta x^3 + b_i \Delta x^2 + c_i \Delta x + d_i
\end{equation}
\begin{equation}
    p'(x) = 3 a_i \Delta x^2 + 2b \Delta x + c
\end{equation}
\begin{equation}
    p''(x) = 6 a_i \Delta x + 2b
\end{equation}

I te warunki pozwalają na ułożenie układu równań liniowych.

Zanim zaprogramowałem ten układ postawnowiłem rozwiązać sprawdzić jak taki układ powinien wyglądać dla 4 punktów.

Wybrane przeze mnie punkty to $(x_k, y_k)  = (1,1), (2,5), (3,4), (4, 9) $

Najpierw określam ile powinno być wielomianów w układzie równań 
\begin{equation}
n=(2*(N-2)+2)/2 = (2*(4-2)+2)/2 = 3 
\end{equation}
Możemy więc wyróżnić trzy wielomiany:

\begin{equation}
    p_1(x) = \delta _1 x^3 + \gamma _1 x^2 + \beta _1 x + \alpha _1
\end{equation}
\begin{equation}
    p_2(x) = \delta _2 x^3 + \gamma _2 x^2 + \beta _2 x + \alpha _2
\end{equation}
\begin{equation}
    p_3(x) = \delta _3 x^3 + \gamma _3 x^2 + \beta _3 x + \alpha _3
\end{equation}

Wektor niewiadomych, które musimy obliczyć wygląda następująco:
\begin{equation}
    [\delta _1, \delta_2, \delta_3, \gamma _1, \gamma _2, \gamma_3, \beta _1, \beta _2, \beta _3, \alpha _1, \alpha _2, \alpha _3 ]
\end{equation}


Teraz rozpatruje warunki:

1. Każdy z wielomianów przechodzi przez kolejne punkty
\begin{equation}
    p_1(1) = \delta _1 x_1^3 + \gamma _1 x_1^2 + \beta _1 x_1 + \alpha _1 = 1
\end{equation}
\begin{equation}
    p_1(2) = \delta _1 x_2^3 + \gamma _1 x_2^2 + \beta _1 x_2 + \alpha _1 = 5
\end{equation}
\begin{equation}
    p_1(2) = \delta _2 x_2^3 + \gamma _2 x_2^2 + \beta _2 x_2 + \alpha _2 = 5
\end{equation}
\begin{equation}
    p_1(3) = \delta _2 x_3^3 + \gamma _2 x_3^2 + \beta _2 x_3 + \alpha _2 = 4
\end{equation}
\begin{equation}
    p_1(3) = \delta _3 x_3^3 + \gamma _3 x_3^2 + \beta _3 x_3 + \alpha _3 = 4
\end{equation}
\begin{equation}
    p_1(4) = \delta _3 x_4^3 + \gamma _3 x_4^2 + \beta _3 x_4 + \alpha _3 = 9
\end{equation}

2. Każda pierwsza pochodna dla punktów wewnętrznych jest sobie równa
\begin{equation}
    3 \delta _1 x_2 ^2 + 2 \gamma _1 x_2 + \alpha _1 = 3 \delta _2 x_2 ^2 + 2 \gamma _2 x_2 + \alpha _2
\end{equation}
\begin{equation}
    3 \delta _2 x_3 ^2 + 2 \gamma _2 x_3 + \alpha _2 = 3 \delta _3 x_3 ^2 + 2 \gamma _3 x_3 + \alpha _3
\end{equation}

3. Druga pochodna dla punktów wewnętrznych jest sobie równa
\begin{equation}
    6\delta _1 x_2 + 2 \gamma _1 = 6 \delta _2 x_2 + 2 \gamma _2
\end{equation}
\begin{equation}
    6\delta _2 x_2 + 2 \gamma _2 = 6 \delta _3 x_3 + 2 \gamma _3
\end{equation}

4. Druga pochodna wynosi zero na punktach krańcowych
\begin{equation}
    6\delta _1 x_1 + 2 \gamma _1 = 0
\end{equation}
\begin{equation}
    6\delta _3 x_4 + 2 \gamma _3 = 0
\end{equation}

Przekształcam te równania w macierz tridiagonalną, która połączona jest z dodatkowymi warunkami pochodnych. 
W ten sposób całe obliczenie można wykonać używając operatora rozwiązania równań liniowych w Matlab.


$$
\left( \begin{array}{cccccccccccc}
     1  &  1  &  1  &  1 &   0&    0&    0 &   0&    0&    0&    0&    0 \\
     8  &  4  &  2  &  1 &   0&    0&    0 &   0&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &   8&    4&    2 &   1&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &  27&    9&    3 &   1&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &   0&    0&    0 &   0&   27&    9&    3&    1 \\
     0  &  0  &  0  &  0 &   0&    0&    0 &   0&   64&   16&    4&    1 \\
    12  &  4  &  1  &  0 & -12&   -4&   -1 &   0&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &  27&    6&    1 &   0&  -27&   -6&   -1&    0 \\
    12  &  2  &  0  &  0 & -12&   -2&    0 &   0&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &  18&    2&    0 &   0&  -18&   -2&    0&    0 \\
     6  &  2  &  0  &  0 &   0&    0&    0 &   0&    0&    0&    0&    0 \\
     0  &  0  &  0  &  0 &   0&    0&    0 &   0&    0&   24&    8&    0 \\
\end{array} \right) \left( \begin{array}{c}
\delta _1\\
\delta_2\\
\delta_3\\
\gamma _1\\
\gamma _2\\
\gamma_3\\
\beta _1\\
\beta _2\\
\beta _3\\
\alpha _1\\
\alpha _2\\
\alpha _3 \\
\end{array} \right) = \left( \begin{array}{c}
1 \\
5 \\
5 \\
4 \\
4 \\
9 \\
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
\end{array} \right) 
$$

Z czego współczynniki po rozwiązaniu ukłądu równań wynoszą
$$
\left( \begin{array}{c}
\delta _1\\
\delta_2\\
\delta_3\\
\gamma _1\\
\gamma _2\\
\gamma_3\\
\beta _1\\
\beta _2\\
\beta _3\\
\alpha _1\\
\alpha _2\\
\alpha _3 \\
\end{array} \right) = \left( \begin{array}{c}
-1.1724 \\
3.5172 \\
1.6552 \\
-3.0000 \\
0.8621 \\
-8.6897 \\
26.0690 \\
-19.2759 \\
8.7241 \\
-79.4483 \\
238.3448 \\
-231.5517 \\
\end{array} \right) 
$$

\section{Zadanie 1}

Cele zadania pierwszego:

\begin{itemize}
  \item Zaprezentowanie przebiegów czasowych dla różnych wartości z tabeli
  \item Określenie błędów w odniesieniu do pomiarów z tabeli i przedyskutowanie wyników
  \item Pokazanie różnicy w dokładności metody Eulera i Ulepszonej Metody Eulera
\end{itemize}

\subsection{Wykresy dla wartości z tabeli}

Wykresy zostały wygenerowane dla danych:

Krok: $0.1$

Pojemność cieplna pręta: $cb=3.85[\frac{J}{kg * K}]$ 

Powierzchnia pręta: $A=0.0109[m^2]$

Pojemność cieplna oleju: $cw=4.1813[\frac{J}{kg * K}]$

Współczynnik przewodnictwa: $h=160[kg]$

Masa pręta: $mb=0.2[kg]$

\begin{tabular}{cc}
    \includegraphics[width=200]{Pomiar_1_krok_100.png} &
    \includegraphics[width=200]{Pomiar_2_krok_100.png} \\
    \includegraphics[width=200]{Pomiar_3_krok_100.png} &
    \includegraphics[width=200]{Pomiar_4_krok_100.png} \\
    \includegraphics[width=200]{Pomiar_5_krok_100.png} &
    \includegraphics[width=200]{Pomiar_6_krok_100.png} \\
    \includegraphics[width=200]{Pomiar_7_krok_100.png} &
    \includegraphics[width=200]{Pomiar_8_krok_100.png} 
\end{tabular}

\begin{tabular}{cc}
    \includegraphics[width=200]{Pomiar_9_krok_100.png} &
    \includegraphics[width=200]{Pomiar_10_krok_100.png} 
\end{tabular}

\subsection{Błędy w odniesieniu do danych eksperymentu}
\csvautobooktabular{zad1_dane_krok_100.csv}

$Tb0$ - wartość początkowa temperatury pręta,
$Tw0$ - wartość początkowa oleju,
$czasy$ - czas zanurzenia w pręta w oleju,
$Mw$ - wartość masy wody,
$Tbk$ - końcowa wartość temperatury pręta z eksperymentu,
$Twk$ - końcowa wartość temperatury oleju z eksperymentu,
$eETb$ - błąd metody Eulera dla ostatniej wartości temperatury pręta
$eETw$ - błąd metody Eulera dla ostatniej wartości temperatury oleju
$eUETb$ - błąd Ulepszonej metody Eulera dla ostatniej wartości temperatury pręta
$eUETw$ - błąd Ulepszonej metody Eulera dla ostatniej wartości temperatury oleju

\subsection{Porównanie metod Eulera}

\begin{tabular}{c}
    \includegraphics[width=\textwidth]{Pomiar_1_krok_1.png} \\
    \includegraphics[width=\textwidth]{Pomiar_2_krok_100.png} 
\end{tabular}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Wzory}

\begin{equation}
    \frac{\partial T_b}{\partial t}=\frac{(T_w-T_b)*h*a}{m_b*c_b}
\end{equation}

\begin{equation}
    \frac{\partial T_w}{\partial t}=\frac{(T_w-T_w)*h*a}{m_w*c_w}
\end{equation}

Gdzie 

https://www.youtube.com/watch?v=wMMjF7kXnWA

żeby 

https://youtu.be/gfSKOfHRooQ



Dla punktów 

https://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm



\end{document}

